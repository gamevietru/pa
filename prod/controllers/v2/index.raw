window.__require=function n(t,e,r){function i(o,a){if(!e[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(s)return s(c,!0);throw new Error("Cannot find module '"+o+"'")}o=c}var f=e[o]={exports:{}};t[o][0].call(f.exports,function(n){return i(t[o][1][n]||n)},f,f.exports,n,t,e,r)}return e[o].exports}for(var s="function"==typeof __require&&__require,o=0;o<r.length;o++)i(r[o]);return i}({PAAds:[function(n,t,e){"use strict";cc._RF.push(t,"81f24AUGsVMvY2VK5D4Xbup","PAAds");n("PAManager"),n("PAJS");var r=n("PAUI");cc.Class({extends:cc.Component,onLoad:function(){r.size(this.node,r.size(r.parent(this.node)))},showAsync:function(){var n=this;return new Promise(function(t,e){r.on(n.node,"done",t)})},setDataAsync:function(n){return this.data=n,this.updateDataAsync(n)},updateDataAsync:function(){return Promise.resolve()},onClick:function(){r.emit(this.node,"click")},onSwitch:function(){r.emit(this.node,"switch")},onCancel:function(){r.emit(this.node,"cancel")},onPlay:function(){var n=this;this.onClick();var t={"game-id":this.data.src};FBInstant.switchGameAsync(this.data.app.id,t).then(function(){n.onSwitch()},function(t){n.onCancel()})}}),cc._RF.pop()},{PAJS:"PAJS",PAManager:"PAManager",PAUI:"PAUI"}],PABanners:[function(n,t,e){"use strict";cc._RF.push(t,"f5bc90TKm9MhJuyV/ICcK+0","PABanners");n("PAConfigs");var r=n("PAJS"),i=n("PAUI");cc.Class({extends:cc.Component,ctor:function(){this.prefabs={}},setManager:function(n){this.manager=n},loadAsync:function(){var n=this;if(this.instance)return Promise.resolve(this.instance);if(this.loading)return Promise.reject({reason:"PA_BANNER_LOADING"});var t=this.manager.configs;if(!t)return Promise.reject({reason:"PA_NOT_INITIALIZED"});var e=t.getNext("banner");return e?(this.loading=!0,this.createPrefabAsync(e).then(function(t){n.instance=t,i.emit(n.node,"ready",t)}).finally(function(){return n.loading=!1})):Promise.reject({reason:"PA_BANNER_NOT_AVAILABLE"})},showAsync:function(){if(!this.instance)return Promise.reject({reason:"PA_BANNER_NOT_LOADED"});var n=this.instance,t=n.data.id;return this.instance=null,this.loadAsync(),this.manager.onShow(t,"banner"),FBInstant.logEvent("PA_BANNER_SHOW",0,{id:t}),i.clear(this.node),i.add(n.node,this.node),n.showAsync()},createPrefabAsync:function(n){var t=this,e=this.getPrefabPath(n.template);return this.loadPrefabAsync(e).then(function(e){var r=i.create(e,"PABanner");return i.on(r.node,"click",function(){t.manager.onClick(r.data.id,"banner"),FBInstant.logEvent("PA_BANNER_CLICK",0,{id:r.data.id})}),i.on(r.node,"cancel",function(){FBInstant.logEvent("PA_BANNER_CANCEL",0,{id:r.data.id})}),r.setDataAsync(n).then(function(){return r})})},getPrefabPath:function(n){return r.isString(n)&&!n.startsWith("http")?r.format("banners/%s",n):"prefabs/pa-banner"},loadPrefabAsync:function(n){var t=this;return this.prefabs[n]?Promise.resolve(this.prefabs[n]):this.manager.bundle.loadAsync(n,cc.Prefab).then(function(e){return t.prefabs[n]=e})}}),cc._RF.pop()},{PAConfigs:"PAConfigs",PAJS:"PAJS",PAUI:"PAUI"}],PABanner:[function(n,t,e){"use strict";cc._RF.push(t,"e18efRQc1tDw59VLWzU39x1","PABanner");var r=n("PAUI");cc.Class({extends:n("PAAds"),properties:{bg:cc.Sprite,effect:sp.Skeleton},showAsync:function(){return r.scaleX(this.effect.node,r.size(this.node).width/750),this._super()},updateDataAsync:function(n){return r.spriteAsync(this.bg,n.app.banner)},onClose:function(){r.emit(this.node,"done")},onCancel:function(){this._super(),this.onClose()},onSwitch:function(){this._super(),this.onClose()}}),cc._RF.pop()},{PAAds:"PAAds",PAUI:"PAUI"}],PAConfigs:[function(n,t,e){"use strict";cc._RF.push(t,"8e882nxnuRNX6+kD+jplXXk","PAConfigs");var r=n("PAJS"),i=n("PASettings");cc.Class({ctor:function(n){this.setData(n)},setData:function(n){this.data=n;var t=this._getRemote(n);this.local=this._loadLocal(),this.local&&this.local.version==t.data.version||(this.resetCount(),this.resetRates(),this.local={version:t.data.version,apps:t.apps},this.saveLocal()),t.data&&(this.local.id=t.data.id,this.local.templates=t.data.templates),this.local.configs=t.configs},resetCount:function(){i.remove("pa-inter-count"),i.remove("pa-inter-date")},resetRates:function(){i.remove("pa-data")},getSrcId:function(){return this.local.id},getNext:function(){var n=r.rndKey(this.local.apps,function(n,t){return n[t]});if(n){var t=this.local.templates[n];if(t)return{src:this.local.id,id:n,app:t}}},updateInterCount:function(){var n=i.getNum("pa-inter-date"),t=r.today();return n!=t&&(i.set("pa-inter-count",0),i.set("pa-inter-date",t)),i.inc("pa-inter-count")},getInterCount:function(){return i.getNum("pa-inter-count")},checkInterTurn:function(){var n=i.getNum("pa-inter-count"),t=this.local.configs["inter-index"];return{count:n,turns:t,isTurn:t&&t.includes(n)}},updateAppRate:function(n,t){n&&(this.local.apps[n]*=1-t,this.saveLocal())},hasInter:function(){return this.hasAd("inter")},hasBanner:function(){return this.hasAd("banner")},hasAd:function(n){return!this.local.configs[r.format("no-%s",n)]},onShow:function(n,t){this.updateAppRate(n,this.local.configs[r.format("%s-show",t)]||0)},onClick:function(n,t){this.updateAppRate(n,this.local.configs[r.format("%s-click",t)]||0)},onCancel:function(n,t){},saveLocal:function(){var n=Number.MAX_SAFE_INTEGER;if(r.each(this.local.apps,function(t,e){e>0&&n>e&&(n=e)}),n<.5)for(var t in this.local.apps)this.local.apps[t]*=2;i.set("pa-data",this.local)},_loadLocal:function(){return i.getJson("pa-data")},_getRemote:function(n){var t=this._getSet(n);return{set:t,data:n,apps:n.sets&&(n.sets[t]||n.sets.default),configs:n.configs&&(n.configs[t]||n.configs.default)}},_getSet:function(n){if(n.rules)for(var t in n.rules)if(this._matchRule(n.rules[t]))return n.rules[t].set||t},_matchRule:function(n){for(var t in n){var e=this._getUserValue(t),i=r.isArray(n[t])?n[t]:[n[t]];if(e&&!i.includes(e))return!1}return!0},_getUserValue:function(n){switch(n){case"locale":return FBInstant.getLocale();case"lang":return FBInstant.getLocale().split("_").first();case"country":return FBInstant.getLocale().split("_").last();case"user":return FBInstant.player.getID()}}}),cc._RF.pop()},{PAJS:"PAJS",PASettings:"PASettings"}],PAInters:[function(n,t,e){"use strict";cc._RF.push(t,"434406Is8NH5a+JngPOjGhe","PAInters");var r=n("PAJS"),i=n("PAUI");cc.Class({extends:cc.Component,ctor:function(){this.prefabs={}},setManager:function(n){this.manager=n},loadAsync:function(){var n=this;if(this.instance)return Promise.resolve(this.instance);if(this.loading)return Promise.reject({reason:"PA_INTER_LOADING"});var t=this.manager.configs;if(!t)return Promise.reject({reason:"PA_NOT_INITIALIZED"});var e=t.getNext("inter");return e?(this.loading=!0,this.createPrefabAsync(e).then(function(t){n.instance=t,i.emit(n.node,"ready",t)}).finally(function(){return n.loading=!1})):Promise.reject({reason:"PA_INTER_NOT_AVAILABLE"})},showAsync:function(){if(!this.instance)return Promise.reject({reason:"PA_INTER_NOT_LOADED"});var n=this.instance,t=n.data.id;return this.instance=null,this.loadAsync(),this.manager.onShow(t,"inter"),FBInstant.logEvent("PA_INTER_SHOW",0,{id:t,count:this.manager.configs.getInterCount()}),i.clear(this.node),i.add(n.node,this.node),n.showAsync()},createPrefabAsync:function(n){var t=this,e=this.getPrefabPath(n.template);return this.loadPrefabAsync(e).then(function(e){var r=i.create(e,"PAInter");return i.on(r.node,"click",function(){t.manager.onClick(r.data.id,"inter"),FBInstant.logEvent("PA_INTER_CLICK",0,{id:r.data.id})}),i.on(r.node,"cancel",function(){FBInstant.logEvent("PA_INTER_CANCEL",0,{id:r.data.id})}),r.setDataAsync(n).then(function(){return r})})},getPrefabPath:function(n){return r.isString(n)&&!n.startsWith("http")?r.format("inters/%s",n):"prefabs/pa-inter"},loadPrefabAsync:function(n){var t=this;return this.prefabs[n]?Promise.resolve(this.prefabs[n]):this.manager.bundle.loadAsync(n,cc.Prefab).then(function(e){return t.prefabs[n]=e})}}),cc._RF.pop()},{PAJS:"PAJS",PAUI:"PAUI"}],PAInter:[function(n,t,e){"use strict";cc._RF.push(t,"b2d92hgAz1FO6Hp6fCN+d09","PAInter");n("PAManager");var r=n("PAJS"),i=n("PAUI");cc.Class({extends:n("PAAds"),properties:{content:cc.Node,bg:cc.Sprite,play:cc.Sprite},updateDataAsync:function(n){var t=this,e=n.app.inter;if(e&&!r.isString(e)){var s=i.spriteAsync(this.bg,e.image),o=i.spriteAsync(this.play,e.play.image).then(function(){i.pos(t.play.node,cc.v2(e.play.x,e.play.y))});return Promise.all([s,o])}return Promise.resolve()},showAsync:function(){return this.updateLayout(),i.action(this.play.node,this.createAnimation()),this._super()},createAnimation:function(){return cc.repeatForever(cc.sequence(cc.scaleTo(.15,1.07),cc.scaleTo(.15,1),cc.scaleTo(.15,1.07),cc.scaleTo(.15,1),cc.scaleTo(.15,1.07),cc.scaleTo(.15,1),cc.scaleTo(.15,1.07),cc.scaleTo(.15,1),cc.delayTime(3)))},updateLayout:function(){var n=i.size(this.node),t=i.size(this.bg.node),e=n.width/t.width,r=n.height/t.height,s=n.width/n.height,o=(Math.min(e,r),t.height*s);i.size(this.content,cc.size(o,t.height)),i.scale(this.content,r),i.scale(this.bg.node,cc.v2(Math.max(o/t.width,1),1)),i.pos(this.node,cc.v2(0,0))},onClose:function(){i.emit(this.node,"done"),i.remove(this.node)},onCancel:function(){this._super(),this.onClose()},onSwitch:function(){this._super(),this.onClose()}}),cc._RF.pop()},{PAAds:"PAAds",PAJS:"PAJS",PAManager:"PAManager",PAUI:"PAUI"}],PAJS:[function(n,t,e){"use strict";cc._RF.push(t,"bbff3M0z0dPg5+YQsZCwJVd","PAJS"),t.exports={format:function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var i=0;return n.replace(/\%s/g,function(n){return e[i++]})},now:function(){return(new Date).getTime()/1e3},today:function(){var n=new Date;return n.setHours(0,0,0,0),n.getTime()/1e3},string:function(n){return""+n},number:function(n){return 1*n||0},bool:function(n){return!0===n||1===n||"true"===n||"1"===n},isBool:function(n){return"boolean"==typeof n},isDefined:function(n){return void 0!==n},isFunction:function(n){return"function"==typeof n},isNumber:function(n){return"number"==typeof n},isString:function(n){return"string"==typeof n},isArray:function(n){return n instanceof Array},isEmpty:function(n){return!n||0==n.length},isType:function(n,t){return n instanceof t},each:function(n,t){return this.isArray(n)?this._eachArray(n,t):this._eachObj(n,t)},_eachArray:function(n,t){for(var e=[],r=0;r<n.length;r++)e.push(t(n[r],r));return e},_eachObj:function(n,t){var e=[];for(var r in n)e.push(t(r,n[r]));return e},sum:function(n,t){for(var e=0,r=0;r<n.length;r++)e+=t?t(n[r],r):n[r];return e},rnd:function(){var n=Math.random();switch(arguments.length){case 1:return n*(arguments.length<=0?void 0:arguments[0]);case 2:return(arguments.length<=0?void 0:arguments[0])+((arguments.length<=1?void 0:arguments[1])-(arguments.length<=0?void 0:arguments[0]))*n;default:return n}},rndBool:function(n){return void 0===n&&(n=.5),this.rnd()<n},rndInt:function(n,t){return n+Math.floor(this.rnd()*(t+1-n))},rndItem:function(n){return n[this.rndInt(0,n.length-1)]},rndKey:function(n,t){var e=[],r=[];for(var i in n)r.push(i),e.push(t?t(n,i):100);return r[this.rndChance(e)]},rndValue:function(n){return n[this.rndKey(n)]},rndChance:function(n){for(var t=this.sum(n),e=this.rnd(t),r=0,i=0;i<n.length;i++)if(e<(r+=n[i]))return i;return n.length-1},loop:function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},first:function(n,t){return this.isFunction(t)?this.first(this.where(n,t)):this.isNumber(t)?this.take(n,t):n.length>0?n[0]:void 0},take:function(n,t){return n.slice(0,t)},where:function(n,t){for(var e=[],r=0;r<n.length;r++)t&&!t(n[r],r)||e.push(n[r]);return e}},cc._RF.pop()},{}],PAManager:[function(n,t,e){"use strict";cc._RF.push(t,"18b19tsJmtIOLt0vsHIIxs+","PAManager");var r=n("PAConfigs"),i=n("PAResources"),s=(n("PAJS"),n("PAUI"));cc.Class({extends:cc.Component,properties:{inters:cc.Prefab,banners:cc.Prefab},createInters:function(n){var t=s.create(this.inters,"PAInters");return t.setManager(this),n&&s.add(t.node,n),t},createBanners:function(n){var t=s.create(this.banners,"PABanners");return t.setManager(this),n&&s.add(t.node,n),t},resetCount:function(){this.configs&&this.configs.resetCount()},resetRates:function(){this.configs&&this.configs.resetRates()},setBundle:function(n){this.bundle=n},loadAsync:function(n){var t=this;return i.loadJsonAsync(n).then(function(n){return n.disabled||(t.configs=new r(n)),t.configs})},onShow:function(n,t){this.configs&&this.configs.onShow(n,t)},onClick:function(n,t){this.configs&&this.configs.onClick(n,t)},onCancel:function(n,t){this.configs&&this.configs.onCancel(n,t)}});cc._RF.pop()},{PAConfigs:"PAConfigs",PAJS:"PAJS",PAResources:"PAResources",PAUI:"PAUI"}],PAResources:[function(require,module,exports){"use strict";function parseParameters(n,t,e){if(void 0===e){var r="function"==typeof n;t?(e=t,r||(t=null)):void 0===t&&r&&(e=n,n=null,t=null),void 0!==t&&r&&(t=n,n=null)}return{options:n=n||Object.create(null),onProgress:t,onComplete:e}}function downloadAjax(n,t,e,r){var i=parseParameters(t,e,r),s=(t=i.options,e=i.onProgress,r=i.onComplete,"download failed: "+n+", status: "),o=new XMLHttpRequest;if(o.open("GET",n,!0),void 0!==t.responseType&&(o.responseType=t.responseType),void 0!==t.withCredentials&&(o.withCredentials=t.withCredentials),void 0!==t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),void 0!==t.timeout&&(o.timeout=t.timeout),t.header)for(var a in t.header)o.setRequestHeader(a,t.header[a]);return e&&(o.onprogress=function(n){n.lengthComputable&&e(n.loaded,n.total)}),r&&(o.onload=function(){200===o.status||0===o.status?r(null,o.response):r(new Error(s+o.status+"(no response)"))},o.onerror=function(){r(new Error(s+o.status+"(error)"))},o.ontimeout=function(){r(new Error(s+o.status+"(time out)"))},o.onabort=function(){r(new Error(s+o.status+"(abort)"))}),o.send(null),o}cc._RF.push(module,"13ed6lPvNBLoKT3exkj0OJ7","PAResources"),module.exports={loadAsync:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return new Promise(function(n,e){var r;(r=cc.loader).load.apply(r,t.concat([function(t,r){t?e(t):n(r)}]))})},loadResAsync:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return new Promise(function(n,e){var r;(r=cc.loader).loadRes.apply(r,t.concat([function(t,r){t?e(t):n(r)}]))})},loadAjaxAsync:function(n){return new Promise(function(t,e){downloadAjax(n,function(n,r){n?e(n):t(r)})})},loadJsonAsync:function(n){return this.loadAjaxAsync(n).then(function(n){return JSON.parse(n)})},loadScriptAsync:function loadScriptAsync(url){return this.loadAjaxAsync(url).then(function(d){return eval(d)})},_bundles:{},loadBundleAsync:function(n){return n.startsWith("http")?this.loadRemoteBundleAsync(n):new Promise(function(t,e){cc.assetManager.loadBundle(n,function(n,r){n?e(n):t(r)})})},loadRemoteBundleAsync:function(n){var t=this;if(this._bundles[n])return Promise.resolve(this._bundles[n]);var e=null,r=this.loadJsonAsync(cc.path.join(n,"config.json")).then(function(t){(e=t).base=n+"/"}),i=this.loadScriptAsync(cc.path.join(n,"index.raw"));return Promise.all([r,i]).then(function(){return t._createBundleAsync(e).then(function(e){return t._bundles[n]=e})})},_createBundleAsync:function(n){var t=new cc.AssetManager.Bundle;return t.init(n),t.loadAsync=function(){for(var n=this,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return new Promise(function(t,r){n.load.apply(n,e.concat([function(n,e){n?r(n):t(e)}]))})},t.loadAsync("images/externals").then(function(n){return t._config.externals=n.json,t}).catch(function(){return t})}},cc._RF.pop()},{}],PASettings:[function(n,t,e){"use strict";cc._RF.push(t,"dce59VYI+hJ6oymi2vxCNik","PASettings");var r=n("PAJS");t.exports={has:function(n){return null!==cc.sys.localStorage.getItem(n)},getItem:function(n){return cc.sys.localStorage.getItem(n)},get:function(n,t){void 0===t&&(t="");var e=this.getItem(n);return r.isDefined(e)?e:t},getBool:function(n,t){void 0===t&&(t=!1);var e=this.getItem(n);return r.isDefined(e)?r.bool(e):t},getNum:function(n,t){void 0===t&&(t=0);var e=this.getItem(n);return r.isDefined(e)?r.number(e):t},getJson:function(n,t){var e=this.getItem(n);return e?r.isString(e)?JSON.parse(e):e:t},set:function(n,t){return void 0===t?cc.sys.localStorage.removeItem(n):r.isBool(t)?cc.sys.localStorage.setItem(n,t?"1":""):r.isNumber(t)||r.isString(t)?cc.sys.localStorage.setItem(n,t):cc.sys.localStorage.setItem(n,JSON.stringify(t)),t},inc:function(n){return this.set(n,this.getNum(n,0)+1)},remove:function(n){cc.sys.localStorage.removeItem(n)}},cc._RF.pop()},{PAJS:"PAJS"}],PAUI:[function(n,t,e){"use strict";cc._RF.push(t,"2016bwNGbNCaoeU4r1DmxF6","PAUI");var r=n("PAJS"),i=n("PAResources");t.exports={create:function(n,t){var e=cc.instantiate(n);return t?this.component(e,t):e},parent:function(n,t){if(!r.isDefined(t))return n.getParent();n.setParent(t)},component:function(n,t,e){var r=n.getComponent(t);return!r&&e&&(r=new t,n.addComponent(r)),r},add:function(n,t){return n.parent?n.parent=t:t.addChild(n),n},remove:function(n,t){void 0===t&&(t=!0),n.removeFromParent(t)},clear:function(n,t){void 0===t&&(t=!0),n.removeAllChildren(t)},emit:function(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];n.emit.apply(n,[t].concat(r))},on:function(n,t,e){n.on(t,e)},pos:function(n,t){if(!r.isDefined(t))return n.getPosition();n.setPosition(t)},size:function(n,t){if(!r.isDefined(t))return n.getContentSize();n.setContentSize(t)},scale:function(n,t){if(!r.isDefined(t))return n.scale;n.scale=t},scaleX:function(n,t){if(!r.isDefined(t))return n.scaleX;n.scaleX=t},scaleY:function(n,t){if(!r.isDefined(t))return n.scaleY;n.scaleY=t},sprite:function(n,t,e){r.isString(t)?i.loadAsync(t).then(function(t){n.spriteFrame=new cc.SpriteFrame(t),e&&e()}):r.isType(t,cc.SpriteFrame)?(n.spriteFrame=t,e&&e()):e&&e()},spriteAsync:function(n,t){var e=this;return new Promise(function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.sprite.apply(e,[n,t].concat(i))})},loadAsync:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return new Promise(function(n,e){var r;(r=cc.loader).load.apply(r,t.concat([function(t,r){t?e(t):n(r)}]))})},action:function(n,t){n.runAction(t)}},cc._RF.pop()},{PAJS:"PAJS",PAResources:"PAResources"}]},{},["PAJS","PAResources","PASettings","PAUI","PAAds","PABanner","PABanners","PAConfigs","PAInter","PAInters","PAManager"]);